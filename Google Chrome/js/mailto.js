var mailUrl="https://mail.google.com/mail/?view=cm&fs=1&tf=1&to=";var openInTab=false;(function(){chrome.extension.sendRequest({reqtype:"o"},function(a){if(a.o.mailto){rewriteMailtosOnPage()}})})();function rewriteMailtoToGMailUrl(b){var a=b;var c=a.match(/subject=([^&]*)/i);if(c!=null){c=encodeURIComponent(unescape(c[1]));a=a.replace(/subject=([^&]*)/i,"su="+c)}a=a.replace("?","&");a=a.replace(/CC=/i,"cc=");a=a.replace(/BCC=/i,"bcc=");a=a.replace(/Body=/i,"body=");a=a.replace("mailto:",mailUrl);return a}function rewriteMailtosOnPage(){var a=document.evaluate('//a[contains(@href, "mailto:")]',document,null,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null);var e;var b=[];while(e=a.iterateNext()){b.push(e)}for(var d=0;d<b.length;d++){var c=b[d].getAttribute("href");c=rewriteMailtoToGMailUrl(c);if(openInTab){b[d].setAttribute("href",c);b[d].setAttribute("target","_blank")}else{b[d].setAttribute("href","javascript:void(0)");b[d].setAttribute("onclick","window.open('"+c+"','Compose new message','width=640,height=480')")}b[d].setAttribute("rel","noreferrer")}}if(window==top){};
